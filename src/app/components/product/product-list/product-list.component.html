<div class="product-list-container">

  <!-- Vista para administradores -->
  <div class="card-grid" *ngIf="isAdmin">

    <div class="admin-toolbar">
      <h2 class="product-title">Gestión de Productos</h2>

      <div class="admin-actions">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Buscar producto</mat-label>
          <input
            matInput
            (keyup)="applyFilter($event)"
            placeholder="Filtrar por nombre"
          />
          <button
            mat-icon-button
            matSuffix
            *ngIf="dataSource?.filter"
            (click)="clearFilter()"
          >
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <button
          mat-raised-button
          color="primary"
          class="add-product-btn"
          [routerLink]="['/product-add']"
        >
          <mat-icon>add</mat-icon>
          Nuevo Producto
        </button>
      </div>
    </div>

    <mat-card class="product-card" *ngFor="let product of dataSource?.filteredData">
      <div class="product-image-container">
        <img mat-card-image [src]="product.urlImage" alt="{{ product.name }}" />
      </div>
      <mat-card-content>
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="price">{{ product.price | currency : 'COP' }}</p>
        <p class="description line-clamp">{{ product.description }}</p>
      </mat-card-content>
      <mat-card-actions align="end">
        <button mat-icon-button color="accent" matTooltip="Ver detalles" (click)="viewProduct(product.id)">
          <mat-icon>visibility</mat-icon>
        </button>
        <button mat-icon-button color="primary" matTooltip="Editar" [routerLink]="['/admin/products/edit', product.id]">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" matTooltip="Eliminar" (click)="deleteProduct(product.id)">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <!-- Vista para usuarios -->
  <div class="card-grid" *ngIf="!isAdmin">
    <mat-card class="product-card" *ngFor="let product of dataSource?.data">
      <div class="product-image-container">
        <img mat-card-image [src]="product.urlImage" alt="{{ product.name }}" />
      </div>
      <mat-card-content>
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="price">{{ product.price | currency : 'COP' }}</p>
        <p class="description line-clamp">{{ product.description }}</p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-stroked-button color="primary" (click)="viewProduct(product.id)">
          Ver más
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
